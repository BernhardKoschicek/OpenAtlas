<!DOCTYPE html>
<html lang="{{ session['language'] }}">
    <head>
        <meta charset="UTF-8" />
        <meta name="theme-color" content="#ffffff" />
        <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png" />
        <link rel="icon" type="image/png" href="/favicon/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="/favicon/favicon-16x16.png" sizes="16x16" />
        <link rel="manifest" href="/favicon/manifest.json" />
        <link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" />
        <link rel="stylesheet" href="/css/reset.css?v={{ config['VERSION'] }}" />
        <link rel="stylesheet" href="/js/jquery/jquery-ui-1.12.1/jquery-ui.min.css" />
        <link rel="stylesheet" href="/css/style.css?v={{ config['VERSION'] }}" />
        <link rel="stylesheet" href="/css/color.css?v={{ config['VERSION'] }}" />
        <link rel="stylesheet" href="/css/images.css?v={{ config['VERSION'] }}" />
        <script src="/js/jquery/jquery-3.1.1.min.js"></script>
        <script src="/js/jquery/tablesorter-2.28.5/js/jquery.tablesorter.min.js"></script>
        <script src="/js/jquery/tablesorter-2.28.5/js/jquery.tablesorter.widgets.min.js"></script>
        <script src="/js/jquery/tablesorter-2.28.5/js/extras/jquery.tablesorter.pager.min.js"></script>
        <script src="/js/jquery/tablesorter-2.28.5/js/parsers/parser-input-select.min.js"></script>
        <script src="/js/jquery/jquery-validation-1.15.0/jquery.validate.min.js"></script>
        <script src="/js/jquery/jquery-ui-1.12.1/jquery-ui.min.js"></script>
        <script src="/js/tinymce/tinymce.min.js"></script>
        <script src="/js/functions.js"></script>
        <script src="/js/forms.js"></script>
        {% set js_translation_file = '/js/messages_' + session['language'] + '.js' %}
        {% if js_translation_file|test_file %}
            <script src="{{ js_translation_file }}"></script>
        {% endif %}
        <script type="text/javascript">
            minimumPasswordLength = {{ session['settings']['minimum_password_length'] }};
        </script>
        <title>
            {{ session['settings']['site_name'] }}
            {{ ' - ' + request.path.split('/')[1]|uc_first if request.path.split('/')[1] else '' }}
        </title>
    </head>
    <body>
        <div id="header">
            <div id="logo"><a href="/"></a></div>
            <div id="site-name">
                {{ session['settings']['site_name'] }}
                {% if 'local' in request['url_root'] %}
                    local
                {% endif %}
                <noscript><div class="error">{{ _('warning no js') }}</div></noscript><br /><br />
                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        {% for category, message in messages %}
                            <div class="message {{ category }}">{{ message|uc_first }}</div>
                        {% endfor %}
                    {% endif %}
                {% endwith %}
            </div>
            <div id="header-menu">
                <div>
                    {{ _('version')|uc_first }} {{ config['VERSION'] }} -
                    <a href="{{ url_for('index_changelog') }}">{{ _('changelog')|uc_first }}</a> -
                    <a href="{{ url_for('model_index') }}">{{ _('model')|uc_first }}</a> -
                    <a href="{{ url_for('index_credits') }}">{{ _('credits')|uc_first }}</a> -
                    <a href="{{ url_for('index_contact') }}">{{ _('contact')|uc_first }}</a>
                    {% if 'manager'|is_authorized: %}
                        - <a href="{{ url_for('user_index') }}">{{ _('user')|uc_first }}</a>
                        - <a href="{{ url_for('content_index') }}">{{ _('content')|uc_first }}</a>
                    {% endif  %}
                    {% if 'admin'|is_authorized: %}
                        - <a href="{{ url_for('settings_index') }}">{{ _('settings')|uc_first }}</a>
                    {% endif  %}
                </div>
                {% if current_user.is_authenticated %}
                    <div id="greeting">
                        {{ _('hello')|uc_first }} {{ current_user.username }} |
                        <a href="{{ url_for('profile_index') }}">{{ _('profile')|uc_first }}</a>
                    </div>
                    <div style="clear:both;"></div>
                {% endif %}
                <div id="language-menu">
                    <img class="zoom" src="/images/icons/zoom-in.png" title="{{ _('zoom in') }}"
                        onclick="resizeText(1)" alt="{{ _('zoom in') }}" />
                    <img class="zoom" src="/images/icons/zoom-out.png" title="{{ _('zoom out') }}"
                        onclick="resizeText(-1)" alt="{{ _('zoom out') }}" /> |
                    {% for language in config['LANGUAGES'].keys()|sort: %}
                        {% if 'language' in session and session['language'] == language: %}
                            <span>{{ language|upper }}</span>
                        {% else: %}
                            <a href="{{ url_for('set_locale', language=language) }}">{{ language|upper }}</a>
                        {% endif %}
                    {% endfor %} |
                    {% if current_user.is_authenticated %}
                        <a href="/logout">{{ _('logout')|uc_first }}</a>
                    {% else %}
                        <a href="/login">{{ _('login')|uc_first }}</a>
                    {% endif %}
                </div>
            </div>
        </div>
        <div id="menu">
            {% if current_user.is_authenticated %}
                {% for item in ['overview', 'source', 'event', 'actor', 'place', 'reference', 'hierarchy'] %}
                    {% set css = 'active' if item in request.path or (item == 'overview' and request.path == '/') %}
                    <div class="{{ css|safe }}"><a href="/{{ item }}">{{ _(item)|uc_first }}</a></div>
                {% endfor %}
            {% else %}
                <div class="active"><a href="/">{{ _('overview')|uc_first }}</a></div>
            {% endif %}
        </div>
        <div id="breadcrumb">
            {% block breadcrumb %}{% endblock %}
        </div>
        <div id="content">
            <div style="float:left">{% block content %}{% endblock %}</div>
            {% if debug and 'admin'|is_authorized %}
                <div class="data-table" style="float:right;margin:1em;">
                    <p>Debug</p>
                    {% for name, value in debug_model.items() %}
                        {% if name in ['by codes', 'by id', 'by ids', 'linked', 'user'] %}
                            <div>
                                <div>{{ name }}</div>
                                <div class="table-cell" style="text-align:right;">{{ value }}</div>
                            </div>
                        {% elif name not in ['current'] %}
                            <div>
                                <div>{{ name }}</div>
                                <div class="table-cell" style="text-align:right;">{{ '%0.2f'|format(value) }}</div>
                            </div>
                        {% endif %}
                    {% endfor %}
                    {% if form and form.errors %}
                        {% for fieldName, errorMessages in form.errors.items(): %}
                            {{ fieldName }} - {{ errorMessages[0] }}<br />
                        {% endfor %}
                    {% endif %}
                </div>
            {% endif %}
            {% if 'craws.net' in request['url_root'] %}
                <div style="clear:both;"></div>
                <div id="powered-by">
                    Another <a target="_blank" href="http://openatlas.eu">OpenAtlas</a> project powered by
                    <a target="_blank" href="http://craws.net">craws.net</a>
                </div>
            {% endif %}
        </div>
    </body>
</html>
