{% extends "tabs.html" %}
{% block title_name %} - {{ source.name }}{% endblock %}
{% block breadcrumb %}
    {{ [[_('source'), 'source_index'], source.name]|crumb }}
{% endblock %}

{% block tab_info %}
    <div class="toolbar">
        {{ 'menu/source'|manual }}
        {% if 'contributor'|is_authorized %}
            {{ _('edit')|button(url_for('source_update', id_=source.id)) }}
            {{ source|display_delete_link }}
        {% endif %}
        {{ source.id|bookmark_toggle }}
    </div>
    <h1>{{ source.name }}</h1>
    <div>
        {{ profile_image_id|display_profile_image }}
        <div style="float:left;">
            {{ info|display_info }}
            {{ source|note }}
            {{ source|display_external_references }}
            {{ source|description }}
        </div>
        <div style="clear:both;"></div>
    </div>
{% endblock %}

{% block whatever %}
<div >
    <div class="tab-content">
        {% for name in ['event', 'actor', 'place', 'feature', 'stratigraphic_unit', 'find', 'human_remains'] %}
            {% if name not in ['feature', 'stratigraphic_unit', 'find'] or tables[name].rows %}
                <div class="tab-pane fade" role="tabpanel" id="tab-{{ name }}">
                    {% if 'contributor'|is_authorized and name not in ['feature', 'stratigraphic_unit', 'find'] %}
                        <div class="toolbar">
                            {{ _('add')|button(url_for('source_add', id_=source.id, class_name=name)) }}
                            {% if name == 'place' %}
                                {{ _('place')|button(url_for('place_insert', origin_id=source.id)) }}
                            {% else %}
                                {% for code in config.CLASS_CODES[name]%}
                                    {{ code|get_class_name|button(url_for(name + '_insert', code=code, origin_id=source.id)) }}
                                {% endfor %}
                            {% endif %}
                        </div>
                    {% endif %}
                    {{ tables[name].display(name)|safe }}
                </div>
            {% endif %}
        {% endfor %}
        <div class="tab-pane fade" role="tabpanel" id="tab-text">
            {% if 'contributor'|is_authorized %}
                <div class="toolbar">
                    {{ _('text')|button(url_for('translation_insert', source_id=source.id)) }}
                </div>
            {% endif %}
            {{ tables.text.display('text')|safe }}
        </div>
        <div class="tab-pane fade" role="tabpanel" id="tab-file">
            {% if 'contributor'|is_authorized %}
                <div class="toolbar">
                    {{ _('add')|button(url_for('entity_add_file', id_=source.id)) }}
                    {{ _('file')|button(url_for('file_insert', origin_id=source.id)) }}
                </div>
            {% endif %}
            {{ tables.file.display('file')|safe }}
        </div>
    </div>
</div>
{% endblock %}
